language: perl
bundler_args: --deployment
cache: bundler

sudo: required

perl:
  - "5.24"
  - "5.22"
  - "5.20"
  - "5.18"
  - "5.16"
  - "5.14"
  - "5.12"
  - "5.10"
 
install:
#   - sudo apt-get install libgd
#   - cpanm GD -f
   - cpanm --quiet --notest --skip-satisfied Dist::Zilla
   - cpanm Test::NoTabs
   - "dzil authordeps | grep -vP '[^\\w:]' | cpanm --verbose --notest --skip-satisfied"
   - "dzil listdeps   | grep -vP '[^\\w:]' | grep -v '^GD$' | cpanm --verbose --skip-satisfied"

script:
  - dzil authordeps --missing | cpanm --verbose --notest --skip-satisfied
  - cpanm --uninstall GD
  - dzil smoke --release --author

notifications:
  email:
    recipients:
      - worthmine@gmail.com
    on_success: change
    on_failure: never
